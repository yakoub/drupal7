---
title: Controlling checkboxes html 
layout: main 
permalink: "/content/controlling-checkboxes-html"
---

This post describes how to control drupal checkboxes html output.

Note that for most web designs the default html output that drupal generates should be satisfactory.

Throughout the text i assume our custom module name is "my".

Each drupal form element is defined using `hook_element_info`, and looking at [system\_element\_info](https://api.drupal.org/api/drupal/modules!system!system.module/function/system_element_info/7) provides us with information on how to control checkboxes .

The objective is to change `#theme_wrappers` with custom functions.
But of course it is possiblte to chacge `#theme` as well in addition to `#theme_wrappers`.

And looking at [form\_process\_checkboxes](https://api.drupal.org/api/drupal/includes!form.inc/function/form_process_checkboxes/7) shows us that a pre_render function can be used:


{% highlight php %}
<?php
  $form['filters'] = array(
    '#type' => 'checkboxes',
    '#title' => t('Filters'),
    '#options' => array(),
    '#pre_render' => array(
      'form_pre_render_conditional_form_element',
      'my_prerender_checkboxes',
    ),
    '#theme_wrappers' => array('my_checkboxes_wrapper'),
  );
?>
{% endhighlight %}

The purpose of pre_render is to assign `#theme_wrappers` for each checkbox generated by `form_process_checkboxes`:

{% highlight php %}
<?php
  function my_prerender_checkboxes($elements) {
    if (!$elements) {
      return;
    }
    $checkboxes = element_children($elements);
    foreach ($checkboxes as $key) {
      $elements[$key]['#theme_wrappers'] = array('my_checkbox_wrapper');
    }
    return $elements;
  }
?>
{% endhighlight %}

The function `my_checkboxes_wrapper` will create `<ul>` tag and `my_checkbox_wrapper` the `<li>` items for each checkbox :

{% highlight php %}
<?php
  function theme_my_checkboxes_wrapper($variables) {
    $element = $variables['element'];
    return '<ul class="checkboxes">' . $element['#children'] . '</ul>';
  }
  function theme_my_checkbox_wrapper($variables) {
    $element = $variables['element'];
    $label = theme('form_element_label', $variables);
    return '<li class="checkbox">' . $element['#children'] . $label . '</li>';
  }
?>
{% endhighlight %}

One thing still missing, and that is `hook_theme` implementation :

{% highlight php %}
<?php
  function my_theme() {
    $themes = array();
    $themes['my_checkboxes_wrapper'] = array(
      'render element' => 'element',
    );
    $themes['my_checkbox_wrapper'] = array(
      'render element' => 'element',
    ); 
    return $themes;
  }
?>
{% endhighlight %}

Warning: it is most crucial when overriding drupal core form output to take care not to create security holes.

Examining theme functions in form.inc shows various uses of sanitization functions like `filter_xss_admin`

It also can be seen that `form_element` wrapper still runs in addition to our wrapper, and that is caused by `form_pre_render_conditional_form_element` so that if the `#title` entry is removed then the additional wrapper won't run
